{"version":3,"file":"downloadApkAsync.js","names":["_apkCacheDirectory","dotExpoHomeDirectory","UserSettings","dir","path","join","fs","mkdirpSync","downloadApkAsync","url","downloadProgressCallback","versions","Versions","versionsAsync","androidUrl","filename","parse","name","apkPath","pathExists","downloadAppAsync","undefined"],"sources":["../../src/utils/downloadApkAsync.ts"],"sourcesContent":["import fs from 'fs-extra';\nimport path from 'path';\n\nimport { downloadAppAsync, UserSettings, Versions } from '../internal';\n\nfunction _apkCacheDirectory() {\n  const dotExpoHomeDirectory = UserSettings.dotExpoHomeDirectory();\n  const dir = path.join(dotExpoHomeDirectory, 'android-apk-cache');\n  fs.mkdirpSync(dir);\n  return dir;\n}\n\nexport async function downloadApkAsync(\n  url?: string,\n  downloadProgressCallback?: (roundedProgress: number) => void\n) {\n  if (!url) {\n    const versions = await Versions.versionsAsync();\n    url = versions.androidUrl;\n  }\n\n  const filename = path.parse(url).name;\n  const apkPath = path.join(_apkCacheDirectory(), `${filename}.apk`);\n\n  if (await fs.pathExists(apkPath)) {\n    return apkPath;\n  }\n\n  await downloadAppAsync(url, apkPath, undefined, downloadProgressCallback);\n  return apkPath;\n}\n"],"mappings":";;;;;;;AAAA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AACA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AAEA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;;;AAEA,SAASA,kBAAT,GAA8B;EAC5B,MAAMC,oBAAoB,GAAGC,wBAAA,CAAaD,oBAAb,EAA7B;;EACA,MAAME,GAAG,GAAGC,eAAA,CAAKC,IAAL,CAAUJ,oBAAV,EAAgC,mBAAhC,CAAZ;;EACAK,kBAAA,CAAGC,UAAH,CAAcJ,GAAd;;EACA,OAAOA,GAAP;AACD;;AAEM,eAAeK,gBAAf,CACLC,GADK,EAELC,wBAFK,EAGL;EACA,IAAI,CAACD,GAAL,EAAU;IACR,MAAME,QAAQ,GAAG,MAAMC,oBAAA,CAASC,aAAT,EAAvB;IACAJ,GAAG,GAAGE,QAAQ,CAACG,UAAf;EACD;;EAED,MAAMC,QAAQ,GAAGX,eAAA,CAAKY,KAAL,CAAWP,GAAX,EAAgBQ,IAAjC;;EACA,MAAMC,OAAO,GAAGd,eAAA,CAAKC,IAAL,CAAUL,kBAAkB,EAA5B,EAAiC,GAAEe,QAAS,MAA5C,CAAhB;;EAEA,IAAI,MAAMT,kBAAA,CAAGa,UAAH,CAAcD,OAAd,CAAV,EAAkC;IAChC,OAAOA,OAAP;EACD;;EAED,MAAM,IAAAE,4BAAA,EAAiBX,GAAjB,EAAsBS,OAAtB,EAA+BG,SAA/B,EAA0CX,wBAA1C,CAAN;EACA,OAAOQ,OAAP;AACD"}