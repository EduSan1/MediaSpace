{"version":3,"file":"IosWorkspace.js","names":["getPaths","context","iosProjectDirectory","projectName","supportingDirectory","projectRootDirectory","build","isExpoClientBuild","isAnonymous","config","name","projectNameLabel","replace","toLowerCase","Error","type","data","projectPath","path","join","dirname","ios","workspaceSourcePath","archivePath","intermediatesDirectory"],"sources":["../../src/detach/IosWorkspace.ts"],"sourcesContent":["import path from 'path';\n\n/**\n *  paths returned:\n *    iosProjectDirectory - root directory of an (uncompiled) xcworkspace and obj-c source tree\n *    projectName - xcworkspace project name normalized from context.config\n *    supportingDirectory - location of Info.plist, xib files, etc. during configuration.\n *      for an unbuilt app this is underneath iosProjectDirectory. for a compiled app it's just\n *      a path to the flat xcarchive.\n *    intermediatesDirectory - temporary spot to write whatever files are needed during the\n *      detach/build process but can be discarded afterward.\n */\nfunction getPaths(context: any) {\n  let iosProjectDirectory;\n  let projectName;\n  let supportingDirectory;\n  let projectRootDirectory;\n\n  if (context.build.isExpoClientBuild()) {\n    projectName = 'Exponent';\n  } else if (context.isAnonymous()) {\n    projectName = 'ExpoKitApp';\n  } else if (context.config && context.config.name) {\n    const projectNameLabel = context.config.name;\n    projectName = projectNameLabel.replace(/[^a-z0-9_-]/gi, '-').toLowerCase();\n  } else {\n    throw new Error('Cannot configure an Expo project with no name.');\n  }\n  if (context.type === 'user') {\n    projectRootDirectory = context.data.projectPath;\n    iosProjectDirectory = path.join(context.data.projectPath, 'ios');\n    supportingDirectory = path.join(iosProjectDirectory, projectName, 'Supporting');\n  } else if (context.type === 'service') {\n    projectRootDirectory = path.dirname(context.build.ios.workspaceSourcePath);\n    iosProjectDirectory = context.build.ios.workspaceSourcePath;\n    if (context.data.archivePath) {\n      // compiled archive has a flat NSBundle\n      supportingDirectory = context.data.archivePath;\n    } else {\n      supportingDirectory = path.join(iosProjectDirectory, projectName, 'Supporting');\n    }\n  } else {\n    throw new Error(`Unsupported StandaloneContext type: ${context.type}`);\n  }\n  // sandbox intermediates directory by workspace so that concurrently operating\n  // contexts do not interfere with one another.\n  const intermediatesDirectory = path.join(\n    iosProjectDirectory,\n    context.build.isExpoClientBuild() ? 'ExponentIntermediates' : 'ExpoKitIntermediates'\n  );\n  return {\n    projectRootDirectory,\n    intermediatesDirectory,\n    iosProjectDirectory,\n    projectName,\n    supportingDirectory,\n  };\n}\n\nexport { getPaths };\n"],"mappings":";;;;;;;AAAA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,QAAT,CAAkBC,OAAlB,EAAgC;EAC9B,IAAIC,mBAAJ;EACA,IAAIC,WAAJ;EACA,IAAIC,mBAAJ;EACA,IAAIC,oBAAJ;;EAEA,IAAIJ,OAAO,CAACK,KAAR,CAAcC,iBAAd,EAAJ,EAAuC;IACrCJ,WAAW,GAAG,UAAd;EACD,CAFD,MAEO,IAAIF,OAAO,CAACO,WAAR,EAAJ,EAA2B;IAChCL,WAAW,GAAG,YAAd;EACD,CAFM,MAEA,IAAIF,OAAO,CAACQ,MAAR,IAAkBR,OAAO,CAACQ,MAAR,CAAeC,IAArC,EAA2C;IAChD,MAAMC,gBAAgB,GAAGV,OAAO,CAACQ,MAAR,CAAeC,IAAxC;IACAP,WAAW,GAAGQ,gBAAgB,CAACC,OAAjB,CAAyB,eAAzB,EAA0C,GAA1C,EAA+CC,WAA/C,EAAd;EACD,CAHM,MAGA;IACL,MAAM,IAAIC,KAAJ,CAAU,gDAAV,CAAN;EACD;;EACD,IAAIb,OAAO,CAACc,IAAR,KAAiB,MAArB,EAA6B;IAC3BV,oBAAoB,GAAGJ,OAAO,CAACe,IAAR,CAAaC,WAApC;IACAf,mBAAmB,GAAGgB,eAAA,CAAKC,IAAL,CAAUlB,OAAO,CAACe,IAAR,CAAaC,WAAvB,EAAoC,KAApC,CAAtB;IACAb,mBAAmB,GAAGc,eAAA,CAAKC,IAAL,CAAUjB,mBAAV,EAA+BC,WAA/B,EAA4C,YAA5C,CAAtB;EACD,CAJD,MAIO,IAAIF,OAAO,CAACc,IAAR,KAAiB,SAArB,EAAgC;IACrCV,oBAAoB,GAAGa,eAAA,CAAKE,OAAL,CAAanB,OAAO,CAACK,KAAR,CAAce,GAAd,CAAkBC,mBAA/B,CAAvB;IACApB,mBAAmB,GAAGD,OAAO,CAACK,KAAR,CAAce,GAAd,CAAkBC,mBAAxC;;IACA,IAAIrB,OAAO,CAACe,IAAR,CAAaO,WAAjB,EAA8B;MAC5B;MACAnB,mBAAmB,GAAGH,OAAO,CAACe,IAAR,CAAaO,WAAnC;IACD,CAHD,MAGO;MACLnB,mBAAmB,GAAGc,eAAA,CAAKC,IAAL,CAAUjB,mBAAV,EAA+BC,WAA/B,EAA4C,YAA5C,CAAtB;IACD;EACF,CATM,MASA;IACL,MAAM,IAAIW,KAAJ,CAAW,uCAAsCb,OAAO,CAACc,IAAK,EAA9D,CAAN;EACD,CA/B6B,CAgC9B;EACA;;;EACA,MAAMS,sBAAsB,GAAGN,eAAA,CAAKC,IAAL,CAC7BjB,mBAD6B,EAE7BD,OAAO,CAACK,KAAR,CAAcC,iBAAd,KAAoC,uBAApC,GAA8D,sBAFjC,CAA/B;;EAIA,OAAO;IACLF,oBADK;IAELmB,sBAFK;IAGLtB,mBAHK;IAILC,WAJK;IAKLC;EALK,CAAP;AAOD"}