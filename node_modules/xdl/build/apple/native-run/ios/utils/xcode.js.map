{"version":3,"file":"xcode.js","names":["getXCodePath","stdout","execFile","encoding","trim","Error","getDeveloperDiskImagePath","version","xCodePath","versionDirs","fs","promises","readdir","versionPrefix","match","dir","includes"],"sources":["../../../../../src/apple/native-run/ios/utils/xcode.ts"],"sourcesContent":["/**\n * Copyright (c) 2021 Expo, Inc.\n * Copyright (c) 2018 Drifty Co.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport fs from 'fs';\n\nimport { execFile } from '../../utils/process';\n\nexport async function getXCodePath() {\n  try {\n    const { stdout } = await execFile('xcode-select', ['-p'], {\n      encoding: 'utf8',\n    });\n    if (stdout) {\n      return stdout.trim();\n    }\n  } catch {\n    // ignore\n  }\n  throw new Error('Unable to get Xcode location. Is Xcode installed?');\n}\n\nexport async function getDeveloperDiskImagePath(version: string) {\n  const xCodePath = await getXCodePath();\n  const versionDirs = await fs.promises.readdir(\n    `${xCodePath}/Platforms/iPhoneOS.platform/DeviceSupport/`\n  );\n  const versionPrefix = version.match(/\\d+\\.\\d+/);\n  if (versionPrefix === null) {\n    throw new Error(`Invalid iOS version: ${version}`);\n  }\n  // Can look like \"11.2 (15C107)\"\n  for (const dir of versionDirs) {\n    if (dir.includes(versionPrefix[0])) {\n      return `${xCodePath}/Platforms/iPhoneOS.platform/DeviceSupport/${dir}/DeveloperDiskImage.dmg`;\n    }\n  }\n  throw new Error(\n    `Unable to find Developer Disk Image path for SDK ${version}. Do you have the right version of Xcode?`\n  );\n}\n"],"mappings":";;;;;;;;AAOA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AAEA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;;;AATA;AACA;AACA;AACA;AACA;AACA;AACA;AAKO,eAAeA,YAAf,GAA8B;EACnC,IAAI;IACF,MAAM;MAAEC;IAAF,IAAa,MAAM,IAAAC,mBAAA,EAAS,cAAT,EAAyB,CAAC,IAAD,CAAzB,EAAiC;MACxDC,QAAQ,EAAE;IAD8C,CAAjC,CAAzB;;IAGA,IAAIF,MAAJ,EAAY;MACV,OAAOA,MAAM,CAACG,IAAP,EAAP;IACD;EACF,CAPD,CAOE,MAAM,CACN;EACD;;EACD,MAAM,IAAIC,KAAJ,CAAU,mDAAV,CAAN;AACD;;AAEM,eAAeC,yBAAf,CAAyCC,OAAzC,EAA0D;EAC/D,MAAMC,SAAS,GAAG,MAAMR,YAAY,EAApC;EACA,MAAMS,WAAW,GAAG,MAAMC,aAAA,CAAGC,QAAH,CAAYC,OAAZ,CACvB,GAAEJ,SAAU,6CADW,CAA1B;EAGA,MAAMK,aAAa,GAAGN,OAAO,CAACO,KAAR,CAAc,UAAd,CAAtB;;EACA,IAAID,aAAa,KAAK,IAAtB,EAA4B;IAC1B,MAAM,IAAIR,KAAJ,CAAW,wBAAuBE,OAAQ,EAA1C,CAAN;EACD,CAR8D,CAS/D;;;EACA,KAAK,MAAMQ,GAAX,IAAkBN,WAAlB,EAA+B;IAC7B,IAAIM,GAAG,CAACC,QAAJ,CAAaH,aAAa,CAAC,CAAD,CAA1B,CAAJ,EAAoC;MAClC,OAAQ,GAAEL,SAAU,8CAA6CO,GAAI,yBAArE;IACD;EACF;;EACD,MAAM,IAAIV,KAAJ,CACH,oDAAmDE,OAAQ,2CADxD,CAAN;AAGD"}