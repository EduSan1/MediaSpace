{"version":3,"file":"validateKeystore.js","names":["validateKeystoreAsync","keystore","keystoreBase64","keystorePassword","keyAlias","commandExists","e","Log","warn","terminalLink","temporary","write","task","Buffer","from","keystorePath","spawnAsync","Error","stdout","message"],"sources":["../../../src/credentials/utils/validateKeystore.ts"],"sourcesContent":["import spawnAsync from '@expo/spawn-async';\nimport commandExists from 'command-exists';\nimport temporary from 'tempy';\nimport terminalLink from 'terminal-link';\n\nimport Log from '../../log';\n\nexport default async function validateKeystoreAsync({\n  keystore: keystoreBase64,\n  keystorePassword,\n  keyAlias,\n}: {\n  keystore: string;\n  keystorePassword: string;\n  keyAlias: string;\n}) {\n  try {\n    await commandExists('keytool');\n  } catch (e: any) {\n    Log.warn(\n      `Couldn't validate the provided Android keystore because the 'keytool' command is not available. Make sure that you have a Java Development Kit installed. See ${terminalLink(\n        'https://openjdk.java.net',\n        'https://openjdk.java.net'\n      )} to install OpenJDK.`\n    );\n    return;\n  }\n\n  try {\n    await temporary.write.task(Buffer.from(keystoreBase64, 'base64'), async keystorePath => {\n      await spawnAsync('keytool', [\n        '-list',\n        '-keystore',\n        keystorePath,\n        '-storepass',\n        keystorePassword,\n        '-alias',\n        keyAlias,\n      ]);\n    });\n  } catch (e: any) {\n    throw new Error(\n      `An error occurred when validating the Android keystore: ${\n        e.stdout || e.message\n      }\\nMake sure that you provided correct credentials in 'credentials.json' and the path provided under 'keystorePath' points to a valid keystore file.`\n    );\n  }\n}\n"],"mappings":";;;;;;;AAAA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AACA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AACA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AACA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AAEA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;;;AAEe,eAAeA,qBAAf,CAAqC;EAClDC,QAAQ,EAAEC,cADwC;EAElDC,gBAFkD;EAGlDC;AAHkD,CAArC,EAQZ;EACD,IAAI;IACF,MAAM,IAAAC,wBAAA,EAAc,SAAd,CAAN;EACD,CAFD,CAEE,OAAOC,CAAP,EAAe;IACfC,cAAA,CAAIC,IAAJ,CACG,iKAAgK,IAAAC,uBAAA,EAC/J,0BAD+J,EAE/J,0BAF+J,CAG/J,sBAJJ;;IAMA;EACD;;EAED,IAAI;IACF,MAAMC,gBAAA,CAAUC,KAAV,CAAgBC,IAAhB,CAAqBC,MAAM,CAACC,IAAP,CAAYZ,cAAZ,EAA4B,QAA5B,CAArB,EAA4D,MAAMa,YAAN,IAAsB;MACtF,MAAM,IAAAC,qBAAA,EAAW,SAAX,EAAsB,CAC1B,OAD0B,EAE1B,WAF0B,EAG1BD,YAH0B,EAI1B,YAJ0B,EAK1BZ,gBAL0B,EAM1B,QAN0B,EAO1BC,QAP0B,CAAtB,CAAN;IASD,CAVK,CAAN;EAWD,CAZD,CAYE,OAAOE,CAAP,EAAe;IACf,MAAM,IAAIW,KAAJ,CACH,2DACCX,CAAC,CAACY,MAAF,IAAYZ,CAAC,CAACa,OACf,qJAHG,CAAN;EAKD;AACF"}