{"version":3,"file":"SetupIosDist.js","names":["SetupIosDist","constructor","app","open","ctx","user","Error","configuredDistCert","ios","getDistCert","isValid","iosDistView","validateDistributionCertificate","CreateOrReuseDistributionCert"],"sources":["../../../src/credentials/views/SetupIosDist.ts"],"sourcesContent":["import { AppLookupParams } from '../api/IosApi';\nimport { Context, IView } from '../context';\nimport * as iosDistView from './IosDistCert';\n\nexport class SetupIosDist implements IView {\n  constructor(private app: AppLookupParams) {}\n\n  async open(ctx: Context): Promise<IView | null> {\n    if (!ctx.user) {\n      throw new Error(`This workflow requires you to be logged in.`);\n    }\n\n    const configuredDistCert = await ctx.ios.getDistCert(this.app);\n\n    if (configuredDistCert) {\n      // we dont need to setup if we have a valid dist cert on file\n      const isValid = await iosDistView.validateDistributionCertificate(ctx, configuredDistCert);\n      if (isValid) {\n        return null;\n      }\n    }\n\n    return new iosDistView.CreateOrReuseDistributionCert(this.app);\n  }\n}\n"],"mappings":";;;;;;;AAEA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;;;;;AAEO,MAAMA,YAAN,CAAoC;EACzCC,WAAW,CAASC,GAAT,EAA+B;IAAA,KAAtBA,GAAsB,GAAtBA,GAAsB;EAAE;;EAElC,MAAJC,IAAI,CAACC,GAAD,EAAsC;IAC9C,IAAI,CAACA,GAAG,CAACC,IAAT,EAAe;MACb,MAAM,IAAIC,KAAJ,CAAW,6CAAX,CAAN;IACD;;IAED,MAAMC,kBAAkB,GAAG,MAAMH,GAAG,CAACI,GAAJ,CAAQC,WAAR,CAAoB,KAAKP,GAAzB,CAAjC;;IAEA,IAAIK,kBAAJ,EAAwB;MACtB;MACA,MAAMG,OAAO,GAAG,MAAMC,WAAW,GAACC,+BAAZ,CAA4CR,GAA5C,EAAiDG,kBAAjD,CAAtB;;MACA,IAAIG,OAAJ,EAAa;QACX,OAAO,IAAP;MACD;IACF;;IAED,OAAO,KAAIC,WAAW,GAACE,6BAAhB,EAA8C,KAAKX,GAAnD,CAAP;EACD;;AAnBwC"}