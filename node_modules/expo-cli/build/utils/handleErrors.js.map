{"version":3,"file":"handleErrors.js","names":["handleErrorsAsync","err","command","AbortCommandError","SilentError","isCommandError","isPluginError","AssertionError","Log","error","message","_isApiError","isXDLError","isConfigError","isJsonFileError","isPackageManagerError","code","addNewLineIfNone","formatStackTrace","stacktrace","stack","chalk","gray"],"sources":["../../src/utils/handleErrors.ts"],"sourcesContent":["import { AssertionError } from 'assert';\nimport chalk from 'chalk';\n\nimport { AbortCommandError, SilentError } from '../CommandError';\nimport Log from '../log';\n\nexport async function handleErrorsAsync(err: any, { command = '[unknown]' }: { command?: string }) {\n  // TODO: Find better ways to consolidate error messages\n  if (err instanceof AbortCommandError || err instanceof SilentError) {\n    // Do nothing when a prompt is cancelled or the error is logged in a pretty way.\n  } else if (err.isCommandError || err.isPluginError || err instanceof AssertionError) {\n    Log.error(err.message);\n  } else if (err._isApiError) {\n    Log.error(err.message);\n  } else if (err.isXDLError || err.isConfigError) {\n    Log.error(err.message);\n  } else if (err.isJsonFileError || err.isPackageManagerError) {\n    if (err.code === 'EJSONEMPTY') {\n      // Empty JSON is an easy bug to debug. Often this is thrown for package.json or app.json being empty.\n      Log.error(err.message);\n    } else {\n      Log.addNewLineIfNone();\n      Log.error(err.message);\n      const { formatStackTrace } = await import('./formatStackTrace');\n      const stacktrace = formatStackTrace(err.stack, command);\n      Log.error(chalk.gray(stacktrace));\n    }\n  } else {\n    Log.error(err.message);\n    Log.error(chalk.gray(err.stack));\n  }\n\n  //   process.exit(1);\n}\n"],"mappings":";;;;;;;AAAA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AACA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AAEA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AACA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;;;;;;;AAEO,eAAeA,iBAAf,CAAiCC,GAAjC,EAA2C;EAAEC,OAAO,GAAG;AAAZ,CAA3C,EAA4F;EACjG;EACA,IAAID,GAAG,YAAYE,iCAAf,IAAoCF,GAAG,YAAYG,2BAAvD,EAAoE,CAClE;EACD,CAFD,MAEO,IAAIH,GAAG,CAACI,cAAJ,IAAsBJ,GAAG,CAACK,aAA1B,IAA2CL,GAAG,YAAYM,wBAA9D,EAA8E;IACnFC,cAAA,CAAIC,KAAJ,CAAUR,GAAG,CAACS,OAAd;EACD,CAFM,MAEA,IAAIT,GAAG,CAACU,WAAR,EAAqB;IAC1BH,cAAA,CAAIC,KAAJ,CAAUR,GAAG,CAACS,OAAd;EACD,CAFM,MAEA,IAAIT,GAAG,CAACW,UAAJ,IAAkBX,GAAG,CAACY,aAA1B,EAAyC;IAC9CL,cAAA,CAAIC,KAAJ,CAAUR,GAAG,CAACS,OAAd;EACD,CAFM,MAEA,IAAIT,GAAG,CAACa,eAAJ,IAAuBb,GAAG,CAACc,qBAA/B,EAAsD;IAC3D,IAAId,GAAG,CAACe,IAAJ,KAAa,YAAjB,EAA+B;MAC7B;MACAR,cAAA,CAAIC,KAAJ,CAAUR,GAAG,CAACS,OAAd;IACD,CAHD,MAGO;MACLF,cAAA,CAAIS,gBAAJ;;MACAT,cAAA,CAAIC,KAAJ,CAAUR,GAAG,CAACS,OAAd;;MACA,MAAM;QAAEQ;MAAF,IAAuB,mEAAa,oBAAb,GAA7B;MACA,MAAMC,UAAU,GAAGD,gBAAgB,CAACjB,GAAG,CAACmB,KAAL,EAAYlB,OAAZ,CAAnC;;MACAM,cAAA,CAAIC,KAAJ,CAAUY,gBAAA,CAAMC,IAAN,CAAWH,UAAX,CAAV;IACD;EACF,CAXM,MAWA;IACLX,cAAA,CAAIC,KAAJ,CAAUR,GAAG,CAACS,OAAd;;IACAF,cAAA,CAAIC,KAAJ,CAAUY,gBAAA,CAAMC,IAAN,CAAWrB,GAAG,CAACmB,KAAf,CAAV;EACD,CAxBgG,CA0BjG;;AACD"}