{"version":3,"file":"sendTo.js","names":["askForSendToAsync","cachedValue","UserSettings","getAsync","Log","nested","recipient","promptEmailAsync","message","initial","undefined","nonInteractiveHelp","mergeAsync","sendTo","getRecipient","sendUrlAsync","url","email","chalk","bold","spinner","ora","start","result","Exp","sendAsync","succeed","e","fail"],"sources":["../../../src/commands/utils/sendTo.ts"],"sourcesContent":["import chalk from 'chalk';\nimport { Exp, UserSettings } from 'xdl';\n\nimport Log from '../../log';\nimport { ora } from '../../utils/ora';\nimport { promptEmailAsync } from '../../utils/prompts';\n\nexport async function askForSendToAsync(): Promise<string> {\n  const cachedValue = await UserSettings.getAsync('sendTo', null);\n  Log.nested(\"Enter an email address and we'll send a link\");\n  const recipient = await promptEmailAsync(\n    {\n      message: `Email address`,\n      initial: cachedValue ?? undefined,\n    },\n    { nonInteractiveHelp: 'Please specify email address with --send-to.' }\n  );\n  await UserSettings.mergeAsync({ sendTo: recipient });\n  return recipient;\n}\n\nexport async function getRecipient(sendTo?: string | boolean): Promise<string> {\n  let recipient: string | null = '';\n  if (sendTo) {\n    if (typeof sendTo !== 'boolean') {\n      recipient = sendTo;\n    } else {\n      recipient = await UserSettings.getAsync('sendTo', null);\n    }\n\n    if (!recipient) {\n      return await askForSendToAsync();\n    }\n  }\n\n  return recipient;\n}\nexport async function sendUrlAsync(url: string, recipient: string) {\n  const email = chalk.bold(recipient);\n  const spinner = ora(`Sending URL to ${email}`).start();\n  try {\n    const result = await Exp.sendAsync(recipient, url);\n    spinner.succeed(`Sent URL to ${email}`);\n    return result;\n  } catch (e: any) {\n    spinner.fail(`Failed to email ${email}: ${e.message}`);\n  }\n}\n"],"mappings":";;;;;;;;;AAAA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AACA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AAEA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AACA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AACA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;;;AAEO,eAAeA,iBAAf,GAAoD;EACzD,MAAMC,WAAW,GAAG,MAAMC,mBAAA,CAAaC,QAAb,CAAsB,QAAtB,EAAgC,IAAhC,CAA1B;;EACAC,cAAA,CAAIC,MAAJ,CAAW,8CAAX;;EACA,MAAMC,SAAS,GAAG,MAAM,IAAAC,2BAAA,EACtB;IACEC,OAAO,EAAG,eADZ;IAEEC,OAAO,EAAER,WAAF,aAAEA,WAAF,cAAEA,WAAF,GAAiBS;EAF1B,CADsB,EAKtB;IAAEC,kBAAkB,EAAE;EAAtB,CALsB,CAAxB;EAOA,MAAMT,mBAAA,CAAaU,UAAb,CAAwB;IAAEC,MAAM,EAAEP;EAAV,CAAxB,CAAN;EACA,OAAOA,SAAP;AACD;;AAEM,eAAeQ,YAAf,CAA4BD,MAA5B,EAAwE;EAC7E,IAAIP,SAAwB,GAAG,EAA/B;;EACA,IAAIO,MAAJ,EAAY;IACV,IAAI,OAAOA,MAAP,KAAkB,SAAtB,EAAiC;MAC/BP,SAAS,GAAGO,MAAZ;IACD,CAFD,MAEO;MACLP,SAAS,GAAG,MAAMJ,mBAAA,CAAaC,QAAb,CAAsB,QAAtB,EAAgC,IAAhC,CAAlB;IACD;;IAED,IAAI,CAACG,SAAL,EAAgB;MACd,OAAO,MAAMN,iBAAiB,EAA9B;IACD;EACF;;EAED,OAAOM,SAAP;AACD;;AACM,eAAeS,YAAf,CAA4BC,GAA5B,EAAyCV,SAAzC,EAA4D;EACjE,MAAMW,KAAK,GAAGC,gBAAA,CAAMC,IAAN,CAAWb,SAAX,CAAd;;EACA,MAAMc,OAAO,GAAG,IAAAC,UAAA,EAAK,kBAAiBJ,KAAM,EAA5B,EAA+BK,KAA/B,EAAhB;;EACA,IAAI;IACF,MAAMC,MAAM,GAAG,MAAMC,UAAA,CAAIC,SAAJ,CAAcnB,SAAd,EAAyBU,GAAzB,CAArB;IACAI,OAAO,CAACM,OAAR,CAAiB,eAAcT,KAAM,EAArC;IACA,OAAOM,MAAP;EACD,CAJD,CAIE,OAAOI,CAAP,EAAe;IACfP,OAAO,CAACQ,IAAR,CAAc,mBAAkBX,KAAM,KAAIU,CAAC,CAACnB,OAAQ,EAApD;EACD;AACF"}