{"version":3,"file":"logArtifactUrl.js","names":["assertHTTPS","url","UrlUtils","isHttps","CommandError","logArtifactUrl","platform","projectRoot","options","publicUrl","result","getBuildStatusAsync","current","jobs","filter","job","artifacts","Log","nested"],"sources":["../../../src/commands/url/logArtifactUrl.ts"],"sourcesContent":["import { UrlUtils } from 'xdl';\n\nimport CommandError from '../../CommandError';\nimport Log from '../../log';\nimport { BuildJobFields, getBuildStatusAsync } from '../build/getBuildStatusAsync';\n\ntype ArtifactUrlOptions = {\n  publicUrl?: string;\n};\n\nfunction assertHTTPS(url?: string) {\n  if (url && !UrlUtils.isHttps(url)) {\n    throw new CommandError('INVALID_PUBLIC_URL', '--public-url must be a valid HTTPS URL.');\n  }\n}\n\nexport const logArtifactUrl = (platform: 'ios' | 'android') => async (\n  projectRoot: string,\n  options: ArtifactUrlOptions\n) => {\n  assertHTTPS(options.publicUrl);\n\n  const result = await getBuildStatusAsync(projectRoot, {\n    current: false,\n    ...(options.publicUrl ? { publicUrl: options.publicUrl } : {}),\n  });\n\n  const url = result.jobs?.filter((job: BuildJobFields) => job.platform === platform)[0]?.artifacts\n    ?.url;\n\n  if (!url) {\n    throw new CommandError(\n      `No ${platform} binary file found. Use \"expo build:${platform}\" to create one.`\n    );\n  }\n\n  Log.nested(url);\n};\n"],"mappings":";;;;;;;AAAA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AAEA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AACA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AACA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;;;AAMA,SAASA,WAAT,CAAqBC,GAArB,EAAmC;EACjC,IAAIA,GAAG,IAAI,CAACC,eAAA,CAASC,OAAT,CAAiBF,GAAjB,CAAZ,EAAmC;IACjC,MAAM,KAAIG,uBAAJ,EAAiB,oBAAjB,EAAuC,yCAAvC,CAAN;EACD;AACF;;AAEM,MAAMC,cAAc,GAAIC,QAAD,IAAiC,OAC7DC,WAD6D,EAE7DC,OAF6D,KAG1D;EAAA;;EACHR,WAAW,CAACQ,OAAO,CAACC,SAAT,CAAX;EAEA,MAAMC,MAAM,GAAG,MAAM,IAAAC,0CAAA,EAAoBJ,WAApB,EAAiC;IACpDK,OAAO,EAAE,KAD2C;IAEpD,IAAIJ,OAAO,CAACC,SAAR,GAAoB;MAAEA,SAAS,EAAED,OAAO,CAACC;IAArB,CAApB,GAAuD,EAA3D;EAFoD,CAAjC,CAArB;EAKA,MAAMR,GAAG,mBAAGS,MAAM,CAACG,IAAV,yEAAG,aAAaC,MAAb,CAAqBC,GAAD,IAAyBA,GAAG,CAACT,QAAJ,KAAiBA,QAA9D,EAAwE,CAAxE,CAAH,kFAAG,qBAA4EU,SAA/E,0DAAG,sBACRf,GADJ;;EAGA,IAAI,CAACA,GAAL,EAAU;IACR,MAAM,KAAIG,uBAAJ,EACH,MAAKE,QAAS,uCAAsCA,QAAS,kBAD1D,CAAN;EAGD;;EAEDW,cAAA,CAAIC,MAAJ,CAAWjB,GAAX;AACD,CArBM"}