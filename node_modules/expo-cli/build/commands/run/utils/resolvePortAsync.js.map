{"version":3,"file":"resolvePortAsync.js","names":["resolvePortAsync","projectRoot","reuseExistingPort","defaultPort","fallbackPort","port","parseInt","getenv","int","resolvedPort","choosePortAsync","Log","log","process","env","RCT_METRO_PORT","String"],"sources":["../../../../src/commands/run/utils/resolvePortAsync.ts"],"sourcesContent":["import getenv from 'getenv';\nimport { choosePortAsync } from 'xdl/build/utils/choosePortAsync';\n\nimport Log from '../../../log';\n\nexport async function resolvePortAsync(\n  projectRoot: string,\n  {\n    reuseExistingPort,\n    defaultPort,\n    fallbackPort,\n  }: {\n    reuseExistingPort?: boolean;\n    defaultPort?: string | number;\n    fallbackPort?: number;\n  } = {}\n): Promise<number | null> {\n  let port: number;\n  if (typeof defaultPort === 'string') {\n    port = parseInt(defaultPort, 10);\n  } else if (typeof defaultPort === 'number') {\n    port = defaultPort;\n  } else {\n    port = getenv.int('RCT_METRO_PORT', fallbackPort || 8081);\n  }\n\n  // Only check the port when the bundler is running.\n  const resolvedPort = await choosePortAsync(projectRoot, {\n    defaultPort: port,\n    reuseExistingPort,\n  });\n  if (resolvedPort == null) {\n    Log.log('\\u203A Skipping dev server');\n    // Skip bundling if the port is null\n  } else {\n    // Use the new or resolved port\n    process.env.RCT_METRO_PORT = String(resolvedPort);\n  }\n\n  return resolvedPort;\n}\n"],"mappings":";;;;;;;AAAA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AACA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AAEA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;;;AAEO,eAAeA,gBAAf,CACLC,WADK,EAEL;EACEC,iBADF;EAEEC,WAFF;EAGEC;AAHF,IAQI,EAVC,EAWmB;EACxB,IAAIC,IAAJ;;EACA,IAAI,OAAOF,WAAP,KAAuB,QAA3B,EAAqC;IACnCE,IAAI,GAAGC,QAAQ,CAACH,WAAD,EAAc,EAAd,CAAf;EACD,CAFD,MAEO,IAAI,OAAOA,WAAP,KAAuB,QAA3B,EAAqC;IAC1CE,IAAI,GAAGF,WAAP;EACD,CAFM,MAEA;IACLE,IAAI,GAAGE,iBAAA,CAAOC,GAAP,CAAW,gBAAX,EAA6BJ,YAAY,IAAI,IAA7C,CAAP;EACD,CARuB,CAUxB;;;EACA,MAAMK,YAAY,GAAG,MAAM,IAAAC,kCAAA,EAAgBT,WAAhB,EAA6B;IACtDE,WAAW,EAAEE,IADyC;IAEtDH;EAFsD,CAA7B,CAA3B;;EAIA,IAAIO,YAAY,IAAI,IAApB,EAA0B;IACxBE,cAAA,CAAIC,GAAJ,CAAQ,4BAAR,EADwB,CAExB;;EACD,CAHD,MAGO;IACL;IACAC,OAAO,CAACC,GAAR,CAAYC,cAAZ,GAA6BC,MAAM,CAACP,YAAD,CAAnC;EACD;;EAED,OAAOA,YAAP;AACD"}